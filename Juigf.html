<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy New Year 2026 - Magic Wish</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Kalam:wght@700&family=Yatra+One&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- GLOBAL RESET --- */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            background-color: #050505; 
            color: #fff; 
            font-family: 'Poppins', sans-serif; 
            overflow-x: hidden; 
            text-align: center; 
            padding-bottom: 100px;
            background-image: url('https://cdn.pixabay.com/photo/2017/08/30/01/05/milky-way-2695569_1280.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }
        
        .overlay-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: -1; }

        /* --- ADS SPACE --- */
        .ad-space { width: 300px; height: 50px; background: #222; margin: 10px auto; display: flex; align-items: center; justify-content: center; border: 1px dashed #555; font-size: 0.7rem; color: #777; }

        /* --- CURTAIN (OPENING) --- */
        #curtain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(45deg, #000000, #1a0b1a);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999; transition: transform 1.2s cubic-bezier(0.77, 0, 0.175, 1);
        }
        .curtain-up { transform: translateY(-100%); }
        .open-btn {
            font-size: 5rem; color: #ff0055; animation: heartbeat 1.5s infinite;
            filter: drop-shadow(0 0 20px #ff0055); cursor: pointer;
        }
        .tap-text { font-family: 'Kalam', cursive; font-size: 1.5rem; margin-top: 20px; color: #ffd700; animation: blink 1s infinite; }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        @keyframes blink { 50% { opacity: 0.5; } }

        /* --- MAIN CONTENT --- */
        .container { max-width: 500px; margin: 0 auto; padding: 10px; position: relative; z-index: 2; }

        /* --- BRIGHT NEON HEADER (New Lighting) --- */
        .main-heading {
            font-family: 'Great Vibes', cursive;
            font-size: 4rem;
            color: #fff;
            /* Neon Glow Effect */
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 20px #ff00de,
                0 0 30px #ff00de,
                0 0 40px #ff00de,
                0 0 55px #ff00de,
                0 0 75px #ff00de;
            animation: pulsate 1.5s infinite alternate;
            line-height: 1.2;
            margin-top: 15px;
        }
        
        @keyframes pulsate {
            0% { text-shadow: 0 0 4px #fff, 0 0 10px #fff, 0 0 18px #ff00de, 0 0 38px #ff00de, 0 0 73px #ff00de; }
            100% { text-shadow: 0 0 2px #fff, 0 0 8px #fff, 0 0 15px #ff00de, 0 0 30px #ff00de, 0 0 60px #ff00de; }
        }

        .year-huge { 
            font-size: 4.5rem; font-weight: 900; color: #ffd700; 
            text-shadow: 0 0 10px #ffd700, 0 0 20px #ff6600; 
            margin-bottom: 10px; font-family: 'Yatra One', cursive; 
        }

        /* --- COUNTDOWN --- */
        .countdown-box { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .time-unit {
            background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 215, 0, 0.5);
            padding: 8px; border-radius: 10px; width: 65px;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        .time-val { font-size: 1.5rem; font-weight: bold; color: #ffd700; display: block; }
        .time-lbl { font-size: 0.7rem; text-transform: uppercase; color: #ccc; }

        /* --- NAME & PHOTO --- */
        .wishing-lbl { color: #fff; font-size: 1.2rem; letter-spacing: 2px; margin-top: 10px; font-weight: 600; }
        .user-name-glitch {
            font-size: 2.5rem; font-family: 'Yatra One', cursive;
            background: -webkit-linear-gradient(#eee, #333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px #0ff;
            margin-bottom: 20px; display: inline-block;
            border-bottom: 2px dashed #0ff;
        }

        .photo-area { position: relative; width: 260px; height: 260px; margin: 30px auto 10px auto; display: flex; justify-content: center; align-items: center; }
        .ring-outer {
            position: absolute; width: 100%; height: 100%;
            border-radius: 50%; border: 4px dashed #ffd700;
            box-shadow: 0 0 20px #ffd700;
            animation: rotateRight 10s linear infinite;
        }
        .ring-inner {
            position: absolute; width: 90%; height: 90%;
            border-radius: 50%; border: 4px dotted #ff0055;
            box-shadow: 0 0 20px #ff0055;
            animation: rotateLeft 8s linear infinite;
        }
        .photo-container {
            width: 80%; height: 80%; border-radius: 50%;
            overflow: hidden; border: 3px solid #fff;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5);
            z-index: 5; background: #000;
        }
        .my-photo { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .my-photo:hover { transform: scale(1.1); }
        .photo-caption { font-family: 'Great Vibes', cursive; font-size: 2.2rem; color: #ffd700; margin-top: 5px; text-shadow: 0 0 10px #000; }

        @keyframes rotateRight { 100% { transform: rotate(360deg); } }
        @keyframes rotateLeft { 100% { transform: rotate(-360deg); } }

        /* --- SHAYARI --- */
        .hindi-card {
            background: rgba(20, 0, 10, 0.8);
            border: 2px solid #ff0055;
            border-radius: 15px;
            padding: 20px; margin: 15px 0;
            font-family: 'Kalam', cursive; font-size: 1.3rem; color: #fff;
            line-height: 1.6; box-shadow: 0 0 25px rgba(255, 0, 85, 0.4);
            position: relative; text-shadow: 1px 1px 2px #000;
        }
        .hindi-card::before { content: '‚ùù'; position: absolute; top: -25px; left: 15px; font-size: 3.5rem; color: #ffd700; }

        /* --- DEVELOPER & SOCIAL --- */
        .dev-box { background: #111; border-top: 3px solid #ff0055; padding: 20px; margin-top: 40px; border-radius: 20px 20px 0 0; }
        .dev-header { font-size: 0.9rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .dev-name { font-size: 1.5rem; color: #fff; font-family: 'Yatra One', cursive; margin-bottom: 10px; }
        .social-icons { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .s-btn {
            width: 45px; height: 45px; border-radius: 50%; background: #222; color: #fff;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
            border: 1px solid #444; transition: 0.3s; text-decoration: none;
        }
        .s-btn.ig:hover { background: #E1306C; border-color: #E1306C; box-shadow: 0 0 15px #E1306C; }
        .s-btn.yt:hover { background: #FF0000; border-color: #FF0000; box-shadow: 0 0 15px #FF0000; }
        .s-btn.tg:hover { background: #0088cc; border-color: #0088cc; box-shadow: 0 0 15px #0088cc; }
        
        .donate-btn {
            display: inline-block; padding: 12px 25px; border-radius: 50px;
            background: linear-gradient(45deg, #2196F3, #21CBF3); color: #fff;
            font-weight: bold; text-decoration: none; box-shadow: 0 5px 15px rgba(33, 203, 243, 0.4);
            font-size: 0.9rem; margin-top: 10px;
        }

        /* --- FLOATING BUTTON & MODAL --- */
        .float-edit {
            position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: #ffd700;
            border-radius: 50%; color: #000; font-size: 1.6rem; display: flex; align-items: center;
            justify-content: center; box-shadow: 0 0 25px rgba(255, 215, 0, 0.8);
            z-index: 100; cursor: pointer; animation: bounce 2s infinite; border: 2px solid #fff;
        }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 10000; align-items: center; justify-content: center; overflow-y: auto;
        }
        .modal-box {
            background: linear-gradient(135deg, #222, #000); width: 90%; max-width: 400px; padding: 25px;
            border-radius: 15px; border: 1px solid #ff0055; position: relative; text-align: left;
            max-height: 90vh; overflow-y: auto; box-shadow: 0 0 30px rgba(255,0,85,0.3);
        }
        .close { position: absolute; right: 20px; top: 15px; font-size: 25px; cursor: pointer; color: #fff; }
        
        input[type="text"] { width: 100%; padding: 10px; background: #333; border: 1px solid #555; color: #fff; margin-bottom: 10px; border-radius: 8px; outline: none; font-size: 0.9rem; }
        .up-btn { display: block; width: 100%; padding: 10px; background: #333; border: 1px dashed #aaa; color: #ddd; text-align: center; border-radius: 8px; margin-bottom: 10px; cursor: pointer; }
        .gen-btn { width: 100%; padding: 12px; background: #ff0055; color: #fff; border: none; border-radius: 50px; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin-top: 5px; box-shadow: 0 0 15px #ff0055; }
        .gen-btn:disabled { background: #555; cursor: not-allowed; box-shadow: none; }

        .adv-opt { font-size: 0.8rem; color: #ffd700; margin: 10px 0 5px; cursor: pointer; text-decoration: underline; }
        .adv-box { display: none; background: #2a2a2a; padding: 10px; border-radius: 5px; margin-bottom: 10px; }

        #final-link-area { display: none; margin-top: 15px; background: #111; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #444; }
        
        .share-actions { display: grid; gap: 10px; margin-top: 10px; }
        
        .action-btn {
            display: flex; align-items: center; justify-content: center;
            padding: 10px; border-radius: 50px; text-decoration: none; font-weight: bold; font-size: 0.9rem;
            cursor: pointer; border: none; width: 100%;
        }
        .btn-wa { background: #25D366; color: #fff; }
        .btn-native { background: #ffd700; color: #000; }
        .btn-copy { background: #333; color: #ccc; border: 1px solid #555; }

    </style>
</head>
<body oncontextmenu="return false;">

    <div class="overlay-bg"></div>

    <!-- CURTAIN -->
    <div id="curtain">
        <div class="open-btn" onclick="startShow()">
            <i class="fas fa-gift"></i>
        </div>
        <div class="tap-text">Tap to Open Magic ‚ú®</div>
    </div>

    <!-- MUSIC (Background) -->
    <audio id="bg-music" loop>
        <!-- New Festive Music -->
        <source src="https://cdn.pixabay.com/download/audio/2022/10/28/audio_6508f73111.mp3" type="audio/mp3">
    </audio>

    <!-- AD SPACE 1 -->
    <div class="ad-space">AD SPACE TOP</div>

    <div class="container">
        <!-- Bright Neon Heading -->
        <h1 class="main-heading">Happy New Year</h1>
        <div class="year-huge">2026</div>

        <div class="countdown-box" id="timer">
            <div class="time-unit"><span class="time-val" id="d">00</span><span class="time-lbl">Day</span></div>
            <div class="time-unit"><span class="time-val" id="h">00</span><span class="time-lbl">Hr</span></div>
            <div class="time-unit"><span class="time-val" id="m">00</span><span class="time-lbl">Min</span></div>
            <div class="time-unit"><span class="time-val" id="s">00</span><span class="time-lbl">Sec</span></div>
        </div>

        <div class="wishing-lbl">Wishing You A Very Happy Year</div>
        <div id="display-name" class="user-name-glitch">Your Name</div>

        <div class="photo-area">
            <div class="ring-outer"></div>
            <div class="ring-inner"></div>
            <div class="photo-container">
                <img id="main-photo" src="https://i.ibb.co/6rN1n7p/placeholder-gold.png" class="my-photo" alt="Photo">
            </div>
        </div>
        <div id="caption-name" class="photo-caption">Your Name</div>

        <!-- HINDI SHAYARI -->
        <div class="hindi-card" id="shayari-txt">
            Loading Shayari...
        </div>

        <!-- USER SOCIAL LINKS -->
        <div id="user-social-links" style="display:none; margin-top:15px;">
            <p style="color:#aaa; font-size:0.8rem; margin-bottom:5px;">Follow Me:</p>
            <div style="display:flex; justify-content:center; gap:10px;">
                <a href="#" id="u-ig" class="s-btn ig" target="_blank" style="display:none"><i class="fab fa-instagram"></i></a>
                <a href="#" id="u-fb" class="s-btn" style="background:#4267B2; display:none" target="_blank"><i class="fab fa-facebook-f"></i></a>
                <a href="#" id="u-yt" class="s-btn yt" style="display:none" target="_blank"><i class="fab fa-youtube"></i></a>
            </div>
        </div>

    </div>

    <!-- AD SPACE 2 -->
    <div class="ad-space" style="margin-top:30px;">AD SPACE BOTTOM</div>

    <!-- DEVELOPER SECTION -->
    <div class="dev-box">
        <div class="dev-header">Website Developed By</div>
        <div class="dev-name">Pinku Manish</div>
        
        <div class="social-icons">
            <a href="https://instagram.com/pinku_manish_official" class="s-btn ig"><i class="fab fa-instagram"></i></a>
            <a href="https://youtube.com/@pinku_manish_vlogs" class="s-btn yt"><i class="fab fa-youtube"></i></a>
            <a href="https://t.me/pinkumanish_tech" class="s-btn tg"><i class="fab fa-telegram-plane"></i></a>
        </div>

        <div style="border-top:1px dashed #333; margin:15px 0;"></div>

        <div style="font-size:0.8rem; color:#aaa; margin-bottom:5px;">Support My Work (Donate)</div>
        <a href="upi://pay?pa=pinku@ybl&pn=Pinku%20Manish&cu=INR" class="donate-btn">
            <i class="fas fa-wallet"></i> Paytm / PhonePe / GPay
        </a>
    </div>

    <!-- EDIT BUTTON -->
    <div class="float-edit" onclick="toggleModal()">
        <i class="fas fa-magic"></i>
    </div>

    <!-- MODAL -->
    <div class="modal" id="creator-modal">
        <div class="modal-box">
            <span class="close" onclick="toggleModal()">&times;</span>
            <h3 style="color:#ffd700; text-align:center; margin-bottom:15px;">Create Wish üé®</h3>
            
            <label style="font-size:0.8rem; color:#aaa;">Enter Name <span style="color:red">*</span></label>
            <input type="text" id="inp-name" placeholder="Ex: Pinku Manish">

            <label for="file-upload" class="up-btn" id="up-lbl">
                <i class="fas fa-camera"></i> Upload Photo
            </label>
            <input type="file" id="file-upload" accept="image/*" style="display:none;">

            <!-- User Social Inputs -->
            <label style="font-size:0.8rem; color:#aaa;">Instagram ID (Optional)</label>
            <input type="text" id="inp-ig" placeholder="@username">
            <label style="font-size:0.8rem; color:#aaa;">YouTube Link (Optional)</label>
            <input type="text" id="inp-yt" placeholder="https://youtube.com/@channel">

            <!-- Advanced Options -->
            <div class="adv-opt" onclick="toggleAdv()">+ Custom Link Name</div>
            <div class="adv-box" id="adv-settings">
                <label style="font-size:0.7rem; color:#ccc;">Custom Alias (Ex: pinku2026)</label>
                <input type="text" id="inp-alias" placeholder="Leave empty for random">
            </div>

            <button id="make-btn" class="gen-btn" onclick="generateLink()">Make It ‚ú®</button>

            <!-- Final Link Area -->
            <div id="final-link-area">
                <p style="color:#0f0; font-size:0.9rem; font-weight:bold;">Link Generated! üéâ</p>
                <input type="text" id="share-url" readonly style="font-size:0.8rem; color:#ffd700; text-align:center; background:#000;">
                
                <div class="share-actions">
                    <!-- WhatsApp Share -->
                    <a href="#" id="wa-btn" class="action-btn btn-wa">
                        <i class="fab fa-whatsapp" style="margin-right:5px;"></i> Share on WhatsApp
                    </a>
                    
                    <!-- Native Mobile Share -->
                    <button id="native-share-btn" class="action-btn btn-native" onclick="shareNative()">
                        <i class="fas fa-share-alt" style="margin-right:5px;"></i> Share Link
                    </button>

                    <!-- Copy -->
                    <button class="action-btn btn-copy" onclick="copyLink()">
                        <i class="fas fa-copy" style="margin-right:5px;"></i> Copy Text
                    </button>
                </div>
                <p style="font-size:0.7rem; color:#666; margin-top:5px;">(Use "Share Link" button on Mobile)</p>
            </div>
        </div>
    </div>

    <script>
        // === CONFIG ===
        const IMGBB_KEY = "19254db7c34c475b8b64a3cf8cc72fd8";
        let uploadedUrl = "";

        // 6 SHAYARIS
        const hindiShayaris = [
            "‡§®‡§Ø‡§æ ‡§∏‡§µ‡•á‡§∞‡§æ ‡§®‡§Ø‡•Ä ‡§ï‡§ø‡§∞‡§£ ‡§ï‡•á ‡§∏‡§æ‡§•,\n‡§®‡§Ø‡§æ ‡§¶‡§ø‡§® ‡§è‡§ï ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§∏‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§® ‡§ï‡•á ‡§∏‡§æ‡§•,\n‡§Ü‡§™‡§ï‡•ã ‡§®‡§Ø‡§æ ‡§∏‡§æ‡§≤ 2026 ‡§Æ‡•Å‡§¨‡§æ‡§∞‡§ï ‡§π‡•ã,\n‡§¢‡•á‡§∞ ‡§∏‡§æ‡§∞‡•Ä ‡§¶‡•Å‡§Ü‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§•!",
            "‡§≠‡•Å‡§≤‡§æ ‡§¶‡•ã ‡§¨‡•Ä‡§§‡§æ ‡§π‡•Å‡§Ü ‡§ï‡§≤,\n‡§¶‡§ø‡§≤ ‡§Æ‡•á‡§Ç ‡§¨‡§∏‡§æ‡§ì ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§™‡§≤,\n‡§Æ‡•Å‡§∏‡•ç‡§ï‡•Å‡§∞‡§æ‡§ì ‡§ö‡§æ‡§π‡•á ‡§ú‡•ã ‡§≠‡•Ä ‡§π‡•ã ‡§™‡§≤,\n‡§ñ‡•Å‡§∂‡§ø‡§Ø‡§æ‡§Ç ‡§≤‡•á‡§ï‡§∞ ‡§Ü‡§è‡§ó‡§æ ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§ï‡§≤!",
            "‡§∂‡•á‡§∞ ‡§ï‡§≠‡•Ä ‡§õ‡•Å‡§™‡§ï‡§∞ ‡§∂‡§ø‡§ï‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á,\n‡§¨‡•Å‡•õ‡§¶‡§ø‡§≤ ‡§ï‡§≠‡•Ä ‡§ñ‡•Å‡§≤‡§ï‡§∞ ‡§µ‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á,\n‡§π‡§Æ ‡§µ‡•ã ‡§π‡•à ‡§ú‡•ã 'Happy New Year' ‡§ï‡•á ‡§≤‡§ø‡§è,\n‡§è‡§ï ‡§ú‡§®‡§µ‡§∞‡•Ä ‡§ï‡§æ ‡§á‡§Ç‡§§‡•õ‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á!",
            "‡§ó‡•Å‡§≤ ‡§®‡•á ‡§ó‡•Å‡§≤‡§∂‡§® ‡§∏‡•á ‡§ó‡•Å‡§≤‡§´‡§æ‡§Æ ‡§≠‡•á‡§ú‡§æ ‡§π‡•à,\n‡§∏‡§ø‡§§‡§æ‡§∞‡•ã‡§Ç ‡§®‡•á ‡§Ü‡§∏‡§Æ‡§æ‡§® ‡§∏‡•á ‡§∏‡§≤‡§æ‡§Æ ‡§≠‡•á‡§ú‡§æ ‡§π‡•à,\n‡§Æ‡•Å‡§¨‡§æ‡§∞‡§ï ‡§π‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§®‡§Ø‡§æ ‡§∏‡§æ‡§≤,\n‡§π‡§Æ‡§®‡•á ‡§¶‡§ø‡§≤ ‡§∏‡•á ‡§Ø‡•á ‡§™‡•à‡§ó‡§æ‡§Æ ‡§≠‡•á‡§ú‡§æ ‡§π‡•à!",
            "‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡§ú‡•á ‡§π‡•à ‡§ú‡•ã ‡§≠‡•Ä ‡§∏‡§™‡§®‡•á,\n‡§î‡§∞ ‡§¶‡§ø‡§≤ ‡§Æ‡•á‡§Ç ‡§õ‡•Å‡§™‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§≠‡•Ä ‡§Ö‡§≠‡§ø‡§≤‡§æ‡§∑‡§æ‡§è‡§Ç,\n‡§Ø‡§π ‡§®‡§Ø‡§æ ‡§µ‡§∞‡•ç‡§∑ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§∏‡§ö ‡§ï‡§∞ ‡§ú‡§æ‡§è,\n‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡•Ä ‡§π‡•à ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§Ø‡•á‡§Ç!",
            "‡§°‡•á ‡§¨‡§æ‡§à ‡§°‡•á ‡§§‡•á‡§∞‡•Ä ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡§æ‡§Ç ‡§π‡•ã ‡§ú‡§æ‡§Ø‡•á‡§Ç ‡§°‡§¨‡§≤,\n‡§§‡•á‡§∞‡•Ä ‡§ú‡§ø‡§Ç‡§¶‡§ó‡•Ä ‡§∏‡•á ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§π‡•ã ‡§ú‡§æ‡§Ø‡•á‡§Ç ‡§∏‡§æ‡§∞‡•á ‡§ü‡•ç‡§∞‡§¨‡§≤,\n‡§ñ‡•Å‡§¶‡§æ ‡§∞‡§ñ‡•á ‡§π‡§Æ‡•á‡§∂‡§æ ‡§§‡•Å‡§ù‡•á ‡§∏‡•ç‡§Æ‡§æ‡§∞‡•ç‡§ü ‡§è‡§Ç‡§° ‡§´‡§ø‡§ü,\n‡§§‡•á‡§∞‡•á ‡§≤‡§ø‡§è ‡§®‡•ç‡§Ø‡•Ç ‡§à‡§Ø‡§∞ ‡§π‡•ã ‡§∏‡•Å‡§™‡§∞ ‡§°‡•Å‡§™‡§∞ ‡§π‡§ø‡§ü!"
        ];

        // === INIT ===
        document.addEventListener('DOMContentLoaded', () => {
            // Random Shayari
            const randomIdx = Math.floor(Math.random() * hindiShayaris.length);
            document.getElementById('shayari-txt').innerText = hindiShayaris[randomIdx];

            // Countdown
            setInterval(updateCountdown, 1000);
            updateCountdown();
            // Parse URL
            parseData();
        });

        // 1. Curtain & Audio
        function startShow() {
            document.getElementById('curtain').classList.add('curtain-up');
            
            // Audio Logic
            const audio = document.getElementById('bg-music');
            audio.volume = 0.8; 
            audio.play().then(() => {
                console.log("Music Playing");
            }).catch(e => {
                console.log("Audio requires interaction (Chrome policy)");
            });

            // Start Heavy Confetti
            fireHeavyConfetti();
        }

        // 2. Countdown
        function updateCountdown() {
            const target = new Date("Jan 1, 2026 00:00:00").getTime();
            const now = new Date().getTime();
            const diff = target - now;

            if(diff > 0) {
                document.getElementById('d').innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
                document.getElementById('h').innerText = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                document.getElementById('m').innerText = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                document.getElementById('s').innerText = Math.floor((diff % (1000 * 60)) / 1000);
            } else {
                document.getElementById('timer').innerHTML = "<h2 style='color:#ffd700'>Welcome 2026!</h2>";
            }
        }

        function toggleModal() {
            const m = document.getElementById('creator-modal');
            m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
        }
        function toggleAdv() {
            const b = document.getElementById('adv-settings');
            b.style.display = (b.style.display === 'block') ? 'none' : 'block';
        }

        // 3. Image Upload
        document.getElementById('file-upload').addEventListener('change', async function(e){
            const file = e.target.files[0];
            const lbl = document.getElementById('up-lbl');
            if(!file) return;

            lbl.innerHTML = "Uploading... ‚è≥";
            const fd = new FormData();
            fd.append("image", file);

            try {
                const res = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`, { method: "POST", body: fd });
                const data = await res.json();
                if(data.success) {
                    uploadedUrl = data.data.url;
                    lbl.innerHTML = "‚úÖ Photo Uploaded";
                    lbl.style.color = "#0f0";
                    document.getElementById('main-photo').src = URL.createObjectURL(file);
                } else { throw new Error("Fail"); }
            } catch(err) {
                lbl.innerHTML = "‚ùå Error. Try Again.";
            }
        });

        // 4. GENERATE LINK (FIXED)
        async function generateLink() {
            const btn = document.getElementById('make-btn');
            const name = document.getElementById('inp-name').value.trim();
            const ig = document.getElementById('inp-ig').value.trim();
            const yt = document.getElementById('inp-yt').value.trim();
            const alias = document.getElementById('inp-alias').value.trim();

            if(!name) { alert("Please Enter Your Name!"); return; }

            btn.innerHTML = "Processing... <i class='fas fa-spinner fa-spin'></i>";
            btn.disabled = true;

            const dataObj = { n: name, i: uploadedUrl, s: {g: ig, y: yt} };
            const enc = btoa(unescape(encodeURIComponent(JSON.stringify(dataObj))));
            
            // Check if running on localhost/file to warn user
            let baseUrl = window.location.href.split('?')[0];
            if(baseUrl.includes("file://")) {
                alert("NOTE: You must HOST this file on GitHub/Netlify for the link to work for others!");
            }

            const longUrl = baseUrl + "?d=" + enc;
            let finalShortUrl = longUrl;
            
            try {
                let apiUrl = `https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`;
                if(alias) apiUrl += `&alias=${encodeURIComponent(alias)}`;
                
                const response = await fetch(`https://corsproxy.io/?${encodeURIComponent(apiUrl)}`);
                const text = await response.text();
                if(text.includes("http")) finalShortUrl = text;
            } catch(err) { console.log("Shortener Error", err); }

            // UPDATE UI
            document.getElementById('final-link-area').style.display = 'block';
            document.getElementById('share-url').value = finalShortUrl;
            
            // Fix WhatsApp Button (Use whatsapp:// protocol for mobile)
            const msg = `*${name}* sent you a Premium New Year 2026 Wish! üéÅ‚ú®\nSee here: ${finalShortUrl}`;
            document.getElementById('wa-btn').href = `whatsapp://send?text=${encodeURIComponent(msg)}`;

            btn.innerHTML = "Make It ‚ú®";
            btn.disabled = false;
        }

        // 5. NATIVE SHARE (Fixes the "sharing HTML" issue)
        function shareNative() {
            const url = document.getElementById('share-url').value;
            const name = document.getElementById('inp-name').value;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Happy New Year 2026',
                    text: `${name} has sent you a special wish! ‚ú®`,
                    url: url
                }).catch(console.error);
            } else {
                // Fallback
                copyLink();
                alert("Use the Copy button and paste in WhatsApp!");
            }
        }

        function copyLink() {
            const t = document.getElementById('share-url');
            t.select(); t.setSelectionRange(0,99999);
            navigator.clipboard.writeText(t.value);
            alert("Link Copied!");
        }

        // 6. Parse URL
        function parseData() {
            const p = new URLSearchParams(window.location.search);
            const d = p.get('d');
            if(d) {
                try {
                    const json = JSON.parse(decodeURIComponent(escape(atob(d))));
                    if(json.n) {
                        document.getElementById('display-name').innerText = json.n;
                        document.getElementById('caption-name').innerText = json.n;
                        document.title = json.n + " wishes Happy New Year 2026";
                    }
                    if(json.i) document.getElementById('main-photo').src = json.i;
                    if(json.s) {
                        const box = document.getElementById('user-social-links');
                        if(json.s.g) {
                            const l = document.getElementById('u-ig'); l.style.display='inline-flex';
                            l.href = json.s.g.includes('http') ? json.s.g : `https://instagram.com/${json.s.g.replace('@','')}`;
                        }
                        if(json.s.y) {
                            const l = document.getElementById('u-yt'); l.style.display='inline-flex'; l.href = json.s.y;
                        }
                        box.style.display = 'block';
                    }
                } catch(e) { console.log(e); }
            }
        }

        // 7. HEAVY CONFETTI (More & Better)
        function fireHeavyConfetti() {
            const colors = ['#f00', '#0f0', '#00f', '#ff0', '#0ff', '#f0f', '#ffd700'];
            // Create 150 particles
            for(let i=0; i<150; i++) {
                const c = document.createElement('div');
                const size = Math.random() * 10 + 5;
                c.style.cssText = `
                    position:fixed; top:-20px; 
                    width:${size}px; height:${size}px;
                    background:${colors[Math.floor(Math.random()*colors.length)]};
                    left:${Math.random()*100}vw; 
                    opacity: ${Math.random() + 0.5};
                    border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
                    animation: fall ${Math.random()*3+2}s linear infinite;
                    z-index:998; pointer-events:none;
                `;
                document.body.appendChild(c);
            }
            // Keyframes are already added via JS style injection in previous ver, ensuring it here:
            if(!document.getElementById('confetti-style')) {
                const s = document.createElement('style');
                s.id = 'confetti-style';
                s.innerHTML = `@keyframes fall { 
                    0% { transform: translateY(-20px) rotate(0deg); }
                    100% { transform: translateY(110vh) rotate(720deg); } 
                }`;
                document.head.appendChild(s);
            }
        }
    </script>
</body>
</html>
